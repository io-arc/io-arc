#!/usr/bin/env node
/*!
io-arc
WEB/PWA/SPA boilerplate CLI

https://github.com/io-arc/io-arc/
Version: 0.2.6
License: ISC
Copyright (c) 2020 arc one
*/
"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var t=require("commander"),s=require("kleur"),n=e(require("update-notifier")),r=e(require("fs")),i=e(require("make-dir")),a=e(require("path")),o=e(require("cpx")),c=e(require("inquirer")),p=require("child_process");const l={"@io-arc/types":"^0.2.6","@types/cpx":"^1.5.1","@types/inquirer":"^6.5.0","@types/update-notifier":"^4.1.0","cross-env":"^7.0.2","npm-run-all":"^4.1.5",webpack:"^4.43.0","webpack-cli":"^3.3.11"};var u,h,d={name:"@io-arc/cli",version:"0.2.6",description:"WEB/PWA/SPA boilerplate CLI",keywords:["web","pwa","spa","boilerplate","cli","html","css","javascript","pug","sass","scss","stylus","babel","typescript","manifest","serviceworker"],author:"arc one",homepage:"https://github.com/io-arc/io-arc/",license:"ISC",main:"",directories:{bin:"bin",lib:"lib",test:"tests"},files:["bin"],publishConfig:{access:"public"},repository:{type:"git",url:"https://github.com/io-arc/io-arc.git"},scripts:{prebuild:"eslint lib/*.ts",build:"rollup -c",io:"io-arc"},bin:{"io-arc":"bin/index.js"},dependencies:{commander:"^5.1.0",cpx:"^1.5.0",inquirer:"^7.1.0",json2yaml:"^1.1.0",kleur:"^3.0.3","make-dir":"^3.1.0",rxjs:"^6.5.5","update-notifier":"^4.1.0"},devDependencies:l},m=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};class g{constructor(){u.set(this,[10,17,0]),h.set(this,[0,0,0]);const e=process.versions.node.split(".");for(let t=0;t<0;t++)m(this,h)[t]=parseFloat(e[t])||0}check(){return m(this,u).every((e,t)=>e>=m(this,h)[t])}fail(){console.log(s.red("Please Node.js version update.")),console.log(s.blue(`Require: >= ${m(this,u).join(".")}\nYour version: ${process.versions.node}`)),console.log(s.green("Bye !")),process.exit(1)}}u=new WeakMap,h=new WeakMap;const w=(e,t)=>{console.log(s.red(`Oops X(\nFile create failed for ${e}`)),t&&console.error(t)},f=e=>{/{(.*)}/.test(e)?(e=>{const t=e.indexOf("{"),n=e.indexOf("}"),r=e.substr(0,t),i=e.substr(n+1);e.substr(t+1,n-2).split(",").forEach(e=>{console.log(s.white("File create completed for ")+s.green(r+e+i))})})(e):/\*\*$/.test(e)?(e=>{const t=e.replace("/**","");console.log(s.white("File create completed for ")+s.green(t))})(e):console.log(s.white("File create completed for ")+s.green(e))},y=require("json2yaml");class b{async create(e,t){const s=`config/${e}.yml`,n=y.stringify(t).replace(/^---(\n|\r|\n\r)/g,"").replace(/^\s{2}/gm,"");await i(a.dirname(s));try{r.writeFileSync(s,n),f(s)}catch(e){w(s,e)}}}var v,k=function(e,t,s){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,s),s},j=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};class E extends b{constructor(e,t,s,n,r){super(),v.set(this,void 0),k(this,v,{title:e,url:t,author:s,description:n,siteRoot:r})}async create(){await super.create("default",j(this,v)),await super.create("development",{type:"development"}),await super.create("production",{type:"production"})}}v=new WeakMap;var $,M,D=function(e,t,s){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,s),s},S=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};const T=`${a.dirname(__filename)}/template`;class W{constructor(){$.set(this,void 0),M.set(this,async e=>{await Promise.all(e.map(async e=>{await i(`src/${e}`)}))}),D(this,$,[{source:`${T}/.{editorconfig,gitignore,npmrc,prettierrc,browserslistrc}`,output:""}])}add(e){if(0===e.length)return;const t=[];D(this,$,[...S(this,$),...e].filter(e=>{if(0===t.length)return t.push(e),e;return!!t.every(t=>t.source!==e.source||t.output!=t.output)&&(t.push(e),e)}))}async create(e){await S(this,M).call(this,e),S(this,$).forEach(e=>{o.copySync(e.source,e.output);const t=e.logValue||e.source.split("/").pop(),s=/(.+)/.test(e.output)?/\/$/.test(e.output)?e.output+t:`${e.output}/${t}`:t;f(s)})}}$=new WeakMap,M=new WeakMap;class x{startLog(e){console.log(s.bold().green(`# ${e}`))}fail(){console.log(s.red("Oops X(")),process.exit(1)}}var q,L,O,R,P,I,N=function(e,t,s){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,s),s},A=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};const V="html",_="pug",C="html",F="php";class B extends x{constructor(){super(...arguments),q.set(this,V),L.set(this,C),O.set(this,!1),R.set(this,async e=>{if("html"===e)return;const t=await c.prompt({type:"list",name:"ext",message:"Build file extension",choices:[{name:".html",value:C},{name:".php",value:F}]}).catch(e=>(console.error(e),1));"number"!=typeof t?N(this,L,t.ext):this.fail()}),P.set(this,e=>[{source:`${T}/html/README.md`,output:`src/${e}`},{source:`${T}/html/index.html`,output:`src/${e}`}]),I.set(this,e=>{const t=[{source:`${T}/pug/README.md`,output:`src/${e}`},{source:`${T}/.pug-lintrc.json`,output:""}];return A(this,O)?t.push({source:`${T}/pug/assets/**`,output:`src/${e}/assets`,logValue:"assets"},{source:`${T}/pug/index.pug`,output:`src/${e}`}):t.push({source:`${T}/pug/no-template/index.pug`,output:`src/${e}`}),t})}engine(){return A(this,q)}ext(){return A(this,L)}async questions(){this.startLog("Select HTML template engine");const e=await c.prompt({type:"list",name:"engine",message:"Template engine",choices:[{name:"None (Vanilla HTML)",value:V},{name:"Pug",value:_}]}).catch(e=>(console.error(e),1));"number"!=typeof e?(N(this,q,e.engine),await A(this,R).call(this,e.engine)):this.fail()}taskLibrary(){switch(A(this,q)){case V:return"@io-arc/task-webpack-html";case _:return"@io-arc/task-webpack-pug";default:return null}}async createTemplateQuestion(){const e=(()=>{switch(A(this,q)){case V:return"HTML";case _:return"Pug";default:return""}})();if(A(this,q)!==_)return;const t=await c.prompt({type:"confirm",name:"template",message:`${e} template create?`,default:!1}).catch(e=>(console.error(e),1));"number"!=typeof t?N(this,O,t.template):this.fail()}template(e){switch(A(this,q)){case V:return A(this,P).call(this,e);case _:return A(this,I).call(this,e);default:return[]}}}q=new WeakMap,L=new WeakMap,O=new WeakMap,R=new WeakMap,P=new WeakMap,I=new WeakMap;const H={"@babel/core":"^7.9.6","@babel/plugin-proposal-class-properties":"^7.8.3","@babel/plugin-proposal-private-methods":"^7.8.3","@babel/plugin-syntax-dynamic-import":"^7.8.3","@babel/plugin-transform-template-literals":"^7.8.3","@babel/preset-env":"^7.9.6",eslint:"^7.6.0","eslint-config-prettier":"^6.11.0","eslint-config-standard":"^14.1.1","eslint-plugin-babel":"^5.3.0","eslint-plugin-import":"^2.20.2","eslint-plugin-node":"^11.1.0","eslint-plugin-promise":"^4.2.1","eslint-plugin-standard":"^4.0.1","eslint-plugin-vue":"^6.2.2","node-sass":"^4.14.0",prettier:"^2.0.5",pug:"^2.0.4",stylus:"^0.54.7",vue:"^2.6.11",webpack:"^4.43.0","webpack-cli":"^3.3.11"},J={"@types/config":"^0.0.36","@types/node":"^13.13.4","@typescript-eslint/eslint-plugin":"^2.30.0","@typescript-eslint/parser":"^2.30.0",eslint:"^7.6.0","eslint-config-prettier":"^6.11.0","eslint-loader":"^4.0.2","eslint-plugin-prettier":"^3.1.3","eslint-plugin-vue":"^6.2.2",prettier:"^2.0.5",pug:"^2.0.4",stylus:"^0.54.7",vue:"^2.6.11",webpack:"^4.43.0","webpack-cli":"^3.3.11"},U={"@types/config":"^0.0.36","@types/node":"^13.13.4","@typescript-eslint/eslint-plugin":"^2.30.0","@typescript-eslint/parser":"^2.30.0",eslint:"^7.6.0","eslint-config-prettier":"^6.11.0","eslint-loader":"^4.0.2","eslint-plugin-prettier":"^3.1.3",prettier:"^2.0.5","ts-node":"^8.9.1",webpack:"^4.43.0","webpack-cli":"^3.3.11"},X={"@babel/core":"^7.9.6","@babel/plugin-proposal-class-properties":"^7.8.3","@babel/plugin-proposal-private-methods":"^7.8.3","@babel/plugin-syntax-dynamic-import":"^7.8.3","@babel/plugin-transform-template-literals":"^7.8.3","@babel/preset-env":"^7.9.6","babel-eslint":"^10.1.0",eslint:"^7.6.0","eslint-config-prettier":"^6.11.0","eslint-config-standard":"^14.1.1","eslint-plugin-babel":"^5.3.0","eslint-plugin-import":"^2.20.2","eslint-plugin-node":"^11.1.0","eslint-plugin-promise":"^4.2.1","eslint-plugin-standard":"^4.0.1",prettier:"^2.0.5",webpack:"^4.43.0","webpack-cli":"^3.3.11"},Q={node:">= 10.17.0",npm:">= 5.8.0",yarn:">= 1.7.0"},Y="7.6.0",G="6.10.0",z="^2.0.5",K="8.8.2",Z="3.8.3";var ee,te,se,ne,re=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},ie=function(e,t,s){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,s),s};const ae="typescript",oe="babel",ce="none",pe="vue";class le extends x{constructor(){super(...arguments),ee.set(this,ae),te.set(this,ce),se.set(this,e=>{const t=[],s=re(this,te)===pe?"vue":"babel";return t.push({source:`${T}/lint/js/${s}/.eslintrc.yml`,output:""},{source:`${T}/.babelrc`,output:""},{source:`${T}/js/README.md`,output:`src/${e}`},{source:`${T}/config-vue/.pug-lintrc.json`,output:"config-vue"}),t}),ne.set(this,e=>{const t=[],s=re(this,te)===pe?"vue-ts":"ts";return t.push({source:`${T}/lint/js/${s}/.eslintrc.yml`,output:""},{source:`${T}/tsconfig.json`,output:""},{source:`${T}/ts/README.md`,output:`src/${e}`},{source:`${T}/config-vue/.pug-lintrc.json`,output:"config-vue"}),t})}preprocessor(){return re(this,ee)}framework(){return re(this,te)}async questions(){this.startLog("Select JavaScript preprocessor");const e=await c.prompt([{type:"list",name:"preprocessor",message:"JavaScript preprocessor",choices:[{name:"TypeScript",value:ae},{name:"Babel",value:oe}]},{type:"list",name:"framework",message:"Use framework",choices:[{name:"None",value:ce},{name:"Vue.js",value:pe}]}]).catch(e=>(console.error(e),1));"number"!=typeof e?(ie(this,ee,e.preprocessor),ie(this,te,e.framework)):this.fail()}taskLibrary(){if(re(this,te)===pe)switch(re(this,ee)){case ae:return"@io-arc/task-webpack-vue-typescript";case oe:return"@io-arc/task-webpack-vue";default:return null}else switch(re(this,ee)){case ae:return"@io-arc/task-webpack-typescript";case oe:return"@io-arc/task-webpack-babel";default:return null}}dependencies(){let e={};if(re(this,te)===pe)switch(re(this,ee)){case ae:e={...e,...J};break;case oe:e={...e,...H}}switch(re(this,ee)){case ae:e={...e,...U,typescript:Z,"ts-node":K};break;case oe:e={...e,...X}}return e}template(e){switch(re(this,ee)){case ae:return re(this,ne).call(this,e);case oe:return re(this,se).call(this,e);default:return[]}}}ee=new WeakMap,te=new WeakMap,se=new WeakMap,ne=new WeakMap;var ue,he=function(e,t,s){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,s),s},de=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};class me extends b{constructor(e){super(),ue.set(this,void 0),he(this,ue,{outputDir:"dist",wsDir:{static:"static",html:"html",css:"css",js:"js",img:"img",yaml2json:"yaml2json"},deployDir:e,options:{js:{splitFilename:"asset",eslint:".eslintrc.yml"},fileLoader:{html:{use:!0,hash:!0,target:[{tag:"img",attribute:"src",type:"src"},{tag:"img",attribute:"srcset",type:"srcset"},{tag:"img",attribute:"data-src",type:"src"},{tag:"img",attribute:"data-srcset",type:"srcset"},{tag:"source",attribute:"src",type:"src"}]},css:{use:!0,hash:!0},js:{use:!0,hash:!0}}}})}workingDirectories(){const e=[];return Object.keys(de(this,ue).wsDir).forEach(t=>{e.push(de(this,ue).wsDir[t])}),e}pugToPHP(e,t,s){e===_&&(de(this,ue).options.pug={php:t===F,lint:".pug-lintrc.json"}),s===pe&&(void 0===de(this,ue).options.pug&&(de(this,ue).options.pug={}),de(this,ue).options.pug.vuePugLint="config-vue/.pug-lintrc.json")}tsconfig(e){e===ae&&(de(this,ue).options.js.tsconfig="tsconfig.json")}jsFramework(e){e!==pe||(de(this,ue).options.fileLoader.vue={use:!0,loader:{video:["src","poster"],source:"src",img:"src"}})}wsHTML(){return de(this,ue).wsDir.html}wsCSS(){return de(this,ue).wsDir.css}wsJS(){return de(this,ue).wsDir.js}async create(){await super.create("local",de(this,ue)),await super.create("local-development",{options:{html:{minify:!1},css:{minify:!1},js:{minify:!1,sourceMap:!0},json:{minify:!1}}}),await super.create("local-production",{options:{html:{minify:!0},css:{minify:!0},js:{minify:!0,sourceMap:!1},json:{minify:!0}}})}template(){return[{source:`${T}/img/README.md`,output:`src/${de(this,ue).wsDir.img}`},{source:`${T}/static/README.md`,output:`src/${de(this,ue).wsDir.static}`},{source:`${T}/yaml2json/README.md`,output:`src/${de(this,ue).wsDir.yaml2json}`}]}}ue=new WeakMap;var ge,we=function(e,t,s){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,s),s},fe=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};class ye{constructor(){ge.set(this,void 0),we(this,ge,"declare module '*.yml' {\n  const value: any\n  export default value\n}\n\ndeclare module '*.png'\ndeclare module '*.jpg'\ndeclare module '*.jpeg'\ndeclare module '*.gif'\ndeclare module '*.svg'\ndeclare module '*.webp'\n\n/* webpack define */\ndeclare const IS_PRODUCTION: boolean\ndeclare const SITE_TITLE: string\ndeclare const SITE_URL: string\ndeclare const SITE_AUTHOR: string\ndeclare const SITE_ROOT: string")}addVue(){we(this,ge,fe(this,ge)+"\n\n/* Vue.js */\ndeclare module '*.vue' {\n  import Vue from 'vue'\n  export default Vue\n}")}async create(){await i("types");const e="types/custom.d.ts";we(this,ge,fe(this,ge)+"\n");try{r.writeFileSync(e,fe(this,ge)),f(e)}catch(t){w(e,t)}}}ge=new WeakMap;var be,ve,ke=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},je=function(e,t,s){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,s),s};const Ee="npm",$e="yarn";class Me extends x{constructor(){super(...arguments),be.set(this,!0),ve.set(this,Ee)}isInstall(){return ke(this,be)}async questions(){this.startLog("Package Install");const e=await c.prompt({type:"confirm",name:"install",message:"Library install?",default:!0}).catch(e=>(console.error(e),{install:!1}));je(this,be,e.install)}async packageManager(){const e=await c.prompt({type:"list",name:"manager",message:"Package manager",choices:[{name:"npm",value:Ee},{name:"yarn",value:$e}]}).catch(e=>(console.error(e),{manager:Ee}));je(this,ve,e.manager)}start(e){console.log(s.bold().blue("Install start..."));const t=p.spawn(ke(this,ve),["install"],{cwd:a.resolve(),stdio:"inherit"});console.log(""),t.on("close",t=>{0===t?e&&e():console.error("Install error X(")})}}be=new WeakMap,ve=new WeakMap;var De,Se,Te,We=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};class xe{constructor(e,t,s,n){De.set(this,{name:"",version:"",description:"",main:"",author:"",license:"ISC",engines:Q,scripts:{},devDependencies:{},dependencies:{}}),Se.set(this,e=>{const t={};return Object.keys(e).sort().forEach(s=>{t[s]=e[s]}),t}),Te.set(this,()=>{const e=["vue"],t=Object.keys(We(this,De).devDependencies),s={};for(const n of t)e.includes(n)&&(s[n]=We(this,De).devDependencies[n],delete We(this,De).devDependencies[n]);this.addDependenciesObject(s)}),We(this,De).name=e,We(this,De).version=t,We(this,De).description=s,We(this,De).author=n,We(this,De).devDependencies={"@io-arc/task-browser-sync":"^0.2.6","@io-arc/task-clean":"^0.2.6","@io-arc/task-copy":"^0.2.6","@io-arc/task-manifest":"^0.2.6","@io-arc/task-service-worker":"^0.2.6","@io-arc/task-yaml2json":"^0.2.6","cross-env":l["cross-env"],"npm-run-all":l["npm-run-all"],eslint:Y,"eslint-config-prettier":G,prettier:z,webpack:l.webpack,"webpack-cli":l["webpack-cli"]},We(this,De).scripts={start:"cross-env NODE_ENV=development MODE_ENV=watch npm-run-all -p b:*",build:"cross-env NODE_ENV=development MODE_ENV=once npm-run-all -s clean b:* service-worker",release:"cross-env NODE_ENV=production MODE_ENV=once npm-run-all -s clean b:* service-worker",clean:"ia-clean",server:"ia-browser-sync","service-worker":"ia-sw","b:copy":"ia-copy","b:yaml2json":"ia-yaml2json","b:manifest":"ia-manifest","b:webpack":"webpack"}}addDevDependencies(e){null!=e&&(We(this,De).devDependencies[e]="^0.2.6")}addDevDependenciesObject(e){null!=e&&(We(this,De).devDependencies={...We(this,De).devDependencies,...e})}addDependenciesObject(e){null!=e&&(We(this,De).dependencies={...We(this,De).dependencies,...e})}create(){We(this,Te).call(this),We(this,De).devDependencies=We(this,Se).call(this,We(this,De).devDependencies),We(this,De).dependencies=We(this,Se).call(this,We(this,De).dependencies);try{r.writeFileSync("package.json",JSON.stringify(We(this,De),null,2)),f("package.json")}catch(e){w("package.json",e),process.exit(1)}}}De=new WeakMap,Se=new WeakMap,Te=new WeakMap;const qe={webpack:"^4.42.1","webpack-cli":"^3.3.11"},Le={stylus:"^0.54.7",webpack:"^4.42.1","webpack-cli":"^3.3.11"};var Oe,Re,Pe,Ie,Ne=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},Ae=function(e,t,s){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,s),s};const Ve="css",_e="sass",Ce="stylus";class Fe extends x{constructor(){super(...arguments),Oe.set(this,Ve),Re.set(this,e=>[{source:`${T}/css/README.md`,output:`src/${e}`},{source:`${T}/css/style.css`,output:`src/${e}`}]),Pe.set(this,e=>[{source:`${T}/sass/README.md`,output:`src/${e}`},{source:`${T}/sass/style.scss`,output:`src/${e}`}]),Ie.set(this,e=>[{source:`${T}/stylus/README.md`,output:`src/${e}`},{source:`${T}/stylus/style.styl`,output:`src/${e}`}])}lang(){return Ne(this,Oe)}async questions(){this.startLog("Select CSS Language");const e=await c.prompt([{type:"list",name:"lang",message:"CSS language",choices:[{name:"CSS (Vanilla)",value:Ve},{name:"Sass (SASS/SCSS)",value:_e},{name:"Stylus",value:Ce}]}]).catch(e=>(console.error(e),1));"number"!=typeof e?Ae(this,Oe,e.lang):this.fail()}taskLibrary(){switch(Ne(this,Oe)){case Ve:return"@io-arc/task-webpack-css";case _e:return"@io-arc/task-webpack-sass";case Ce:return"@io-arc/task-webpack-stylus";default:return null}}dependencies(){switch(Ne(this,Oe)){case _e:return qe;case Ce:return Le;default:return null}}template(e){switch(Ne(this,Oe)){case Ve:return Ne(this,Re).call(this,e);case _e:return Ne(this,Pe).call(this,e);case Ce:return Ne(this,Ie).call(this,e);default:return[]}}}Oe=new WeakMap,Re=new WeakMap,Pe=new WeakMap,Ie=new WeakMap;var Be,He,Je,Ue,Xe=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},Qe=function(e,t,s){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,s),s};class Ye extends x{constructor(){super(...arguments),Be.set(this,["common","css"]),He.set(this,["common","js"]),Je.set(this,["common","img"]),Ue.set(this,["common","json"])}async questions(){this.startLog("Deploy settings");const e=await c.prompt([{type:"input",name:"css",message:"CSS files output directory",default:Xe(this,Be).join("/")},{type:"input",name:"js",message:"JavaScript files output directory",default:Xe(this,He).join("/")},{type:"input",name:"img",message:"Image files output directory",default:Xe(this,Je).join("/")},{type:"input",name:"json",message:"YAML to JSON convert files output directory",suffix:`\n ${s.grey("* use @io-arc/task-yaml2json")}`,default:Xe(this,Ue).join("/")}]).catch(e=>(console.error(e),1));"number"!=typeof e?(Qe(this,Be,e.css.split("/").filter(Boolean)),Qe(this,He,e.js.split("/").filter(Boolean)),Qe(this,Je,e.img.split("/").filter(Boolean)),Qe(this,Ue,e.json.split("/").filter(Boolean))):this.fail()}dir(){return{css:Xe(this,Be),js:Xe(this,He),img:Xe(this,Je),json:Xe(this,Ue)}}}Be=new WeakMap,He=new WeakMap,Je=new WeakMap,Ue=new WeakMap;var Ge,ze,Ke,Ze,et=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},tt=function(e,t,s){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,s),s};class st extends x{constructor(){super(...arguments),Ge.set(this,a.basename(process.cwd())),ze.set(this,"1.0.0"),Ke.set(this,""),Ze.set(this,"")}name(){return et(this,Ge)}version(){return et(this,ze)}description(){return et(this,Ke)}author(){return et(this,Ze)}async questions(){this.startLog("Project settings");const e=await c.prompt([{type:"input",name:"name",message:"Project Name",default:et(this,Ge)},{type:"input",name:"version",message:"Project Version",default:et(this,ze)},{type:"input",name:"description",message:"Project Description"},{type:"input",name:"author",message:"Project Author"}]).catch(e=>(console.error(e),1));"number"!=typeof e?(tt(this,Ge,e.name),tt(this,ze,e.version),tt(this,Ke,e.description),tt(this,Ze,e.author)):this.fail()}}Ge=new WeakMap,ze=new WeakMap,Ke=new WeakMap,Ze=new WeakMap;var nt,rt,it,at,ot,ct=function(e,t,s){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,s),s},pt=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};class lt extends x{constructor(e){super(),nt.set(this,""),rt.set(this,""),it.set(this,""),at.set(this,""),ot.set(this,"/"),ct(this,it,e)}title(){return pt(this,nt)}url(){return pt(this,rt)}siteRoot(){return pt(this,ot)}author(){return pt(this,it)}description(){return pt(this,at)}async questions(){this.startLog("Site settings");const e=await c.prompt([{type:"input",name:"title",message:"Site title"},{type:"input",name:"url",message:"Release Site URL",suffix:`\n${s.grey("No final slash required\ne.g. https://foo.com")}`,validate:e=>!/\/$/.test(e)},{type:"input",name:"author",message:"Site author",default:pt(this,it)},{type:"input",name:"description",message:"Site description"},{type:"input",name:"siteRoot",message:"Site root directory",suffix:`\n${s.grey("Always add a slash at the end")}`,default:pt(this,ot)}]).catch(e=>(console.error(e),1));"number"!=typeof e?(ct(this,nt,e.title),ct(this,rt,e.url),ct(this,ot,e.siteRoot),ct(this,it,e.author),ct(this,at,e.description)):this.fail()}}nt=new WeakMap,rt=new WeakMap,it=new WeakMap,at=new WeakMap,ot=new WeakMap;var ut,ht=function(e,t,s){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,s),s},dt=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};class mt{constructor(e,t,s){ut.set(this,void 0);const n=[];null!==e&&n.push(`const { html } = require('${e}')`),null!==t&&n.push(`const { css } = require('${t}')`),null!==s&&n.push(`const { js } = require('${s}')`),ht(this,ut,`${n.join("\n")}\n\nmodule.exports = [html, css, js]\n`)}create(){try{r.writeFileSync("webpack.config.js",dt(this,ut)),f("webpack.config.js")}catch(e){w("webpack.config.js",e)}}}ut=new WeakMap,process.stdin.resume(),process.on("SIGINT",()=>{console.log(s.green("Bye !")),process.exit(0)}),(async()=>{t.program.version("0.2.6").parse(process.argv);const e=new g;if(!e.check())return void e.fail();n({pkg:d}).notify();const r=new W,i=new st;await i.questions();const a=new xe(i.name(),i.version(),i.description(),i.author());console.log("");const o=new lt(i.author());await o.questions(),console.log("");const c=new B;await c.questions(),a.addDevDependencies(c.taskLibrary()),console.log("");const p=new Fe;await p.questions(),a.addDevDependencies(p.taskLibrary()),a.addDevDependenciesObject(p.dependencies()),console.log("");const l=new le;await l.questions(),a.addDevDependencies(l.taskLibrary()),a.addDevDependenciesObject(l.dependencies()),console.log("");const u=new Ye;await u.questions();const h=new me(u.dir());h.pugToPHP(c.engine(),c.ext(),l.framework()),h.jsFramework(l.framework()),h.tsconfig(l.preprocessor());const m=new E(o.title(),o.url(),o.author(),o.description(),o.siteRoot());if(console.log(""),await c.createTemplateQuestion(),r.add(c.template(h.wsHTML())),r.add(p.template(h.wsCSS())),r.add(l.template(h.wsJS())),r.add(h.template()),await r.create(h.workingDirectories()),await h.create(),await m.create(),a.create(),l.preprocessor()===ae){const e=new ye;l.framework()===pe&&e.addVue(),await e.create()}new mt(c.taskLibrary(),p.taskLibrary(),l.taskLibrary()).create(),console.log("");const w=s.bold().blue("Done!\nEnjoy create!!"),f=new Me;await f.questions(),f.isInstall()?(await f.packageManager(),f.start(()=>console.log(w))):console.log(w)})();
